# Protocol

## Note
1. 모든 패킷 데이터는 char 타입
2. 공백 허용

## ESP_M  ← Orange Pi

### Packet example
1. (N^1, 1, 80, 3)
2. (E^daily)

### Table
| SOF | P_ID | DATA    | EOF | 설명    | 데이터 범위                                                                                                                                                                              | 주기  |
| --- | ---- | ------- | --- | ------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----- |
| (   | N^   | R,P,Z,Y | )   | 목 제어 | R = -5.000 ~ 5.000 <br></br> P = -5.000 ~ 5.000 <br></br> Z = 60 ~ 100 <br></br> Y = -5.000 ~ 5.000                                                                                      | Event |
| (   | E^   | daily   | )   | 표정    | daily (평범) <br></br> wink (기쁨) <br></br> sad (슬픔) <br></br> angry (분노) <br></br> moving (당황) <br></br> low_bat (배터리 부족) <br></br> danger (위험) <br></br> mic_wating (음성 기다림) | Event |

## ES2_M → Orange Pi

### Packet example 
1. <T^1\>
2. <C^200\>
3. <D^450, 650\>
4. <B^92.23\>
5. <BD^1h 20m\>
6. <G^37.663998, 127.978462>

### Table

| SOF | P_ID | DATA (ex)            | EOF | 설명        | 데이터 범위 | 주기  |
|-----|------|-----------------|-----|-------------|------------------|-------|
| <   | T^    | 1            | >   | 쓰담 감지   | 0 : no touch <br></br> 1 : touch | 상태 변경 시 |
| <   | C^    | 200             | >   | CO농도 (ppm)      | 0 ~ 10000          | 3초   |
| <   | D^    | 450, 650   | >   | 초음파 센서 1, 2 측정 거리 (mm) | 30~4500 | 100ms |
| <   | B^    | 92.23 | >   | 배터리 잔량 | 0 ~ 100 (%) | 3초   |
| <   | BD^    | 1h 20m | >   | 배터리 지속 시간 | 0h 0m ~ 99h 99m | 3초   |
| <   | G^    | 37.663998, 127.978462 | > | GPS 위치 | Latitude, Longitude | 5초 |

## ESP_M ← ESP_S

### Packet example 
1. \*D^450, 650\*
2. \*B^92.23\*
3. \*BD^1h 20m\*
4. \*G^37.663998, 127.978462\*


### Table 
- 배터리 잔량 계산은 ESP_S에서
  
| SOF | P_ID | DATA (ex) | EOF | 설명 | 데이터 범위 | 주기 |
|-----|------|------|-----|------|------------------|------|
| {   | D^    | 450, 650   | }   | 초음파 센서 1, 2 측정 거리 (mm) | 30~4500 | 100ms |
| {   | B^    | 92.23   | }   | 배터리 잔량 | 0 ~ 100 (%) | 3초 |
| {   | BD^   | 1h 20m   | }   | 배터리 지속 시간 | 0h 0m ~ 99h 99m | 3초 |
| {   | G^    | 37.663998, 127.978462 | } | GPS 위치 | Latitude, Longitude | 5초 |
